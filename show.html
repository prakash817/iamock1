<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
   <div id="show">
        <img src="" alt="">
   </div>
</body>
</html>

<script>

    let book = JSON.parse(localStorage.getItem("book"));
    displayData(book)
    function displayData(ele){
       

            let childDiv = document.createElement("div") ;

            let img = document.createElement("img") ;
            let name = document.createElement("h2") ;
            let author = document.createElement("p") ;
            let edition = document.createElement("p") ;
            let cost = document.createElement("p") ;
            let bb = document.createElement("p") ;
            let date = document.createElement("p") ;

            let cancel = document.createElement("button") ;
            let confirm = document.createElement("button") ;

            img.src =ele.image_url
            name.innerText =+ele.book_name
            author.innerText = "author:"+ele.author
            edition.innerText ="Edition:"+ ele.edition
            cost.innerText ="Cost:"+ele.cost
            bb.innerText="Borrowed By : "+ "johon Doe"
            date.innerText="Date Of Borrow : "+new Date().toLocaleDateString()

            cancel.innerText = "Cancel"
            cancel.addEventListener("click" , ()=>{
                location.href = "user.html"
            })

            confirm.innerText = "Confirm"
            confirm.addEventListener("click" , ()=>{
                let confirmData = JSON.parse(localStorage.getItem("confirm")) || [] ;
                console.log(confirmData , "cconfirm")
                confirmData.push(ele)
                localStorage.setItem("confirm" , JSON.stringify(confirmData)) ;

                fetch("http://localhost:3000/book/"+ele.id , {
                    method:"PATCH",
                    headers:{'Content-Type': 'application/json'},
                    body:JSON.stringify({"borrowed":true})
                })
                    .then(token=> alert("posted succesfully"))
                    .catch(err=>console.log(err))

                location.href = "user.html"

            })

            childDiv.append(name,author,edition,bb,date,cost,cancel,confirm)
            document.getElementById("show") .append(img,childDiv)

    }


</script>